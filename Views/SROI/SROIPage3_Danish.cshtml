@using Impactly_PDF_Generator.Models.Enums
@using Impactly_PDF_Generator.Services
@model SROIPDFGeneratorService
@inject Impactly_PDF_Generator.Utilities.INumberUtility NumberUtility

<!DOCTYPE html>
<html lang="en">
<head> 
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0" />
    <meta http-equiv="X-UA-Compatible" content="ie=edge" />
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@100..900&family=Lora:ital,wght@0,400..700;1,400..700&display=swap" rel="stylesheet">
</head>
<body>
@if (Model._SROIRequestModel.SROIPage3 is not null)
{
    var value = Model._SROIRequestModel.SROIPage3;
    var yOffset = 0;


<?xml version="1.0" encoding="UTF-8"?>
<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 600 846" xmlns:xlink="http://www.w3.org/1999/xlink"><style>
    foreignObject#outcome-description div {
      font-family: Inter;
      font-size: 8px;
      font-weight: 400;
      line-height: 15px;
      word-wrap: break-word;
      text-align: left;
    }
    foreignObject#beneficiary-name div {
        font-family: Inter;
        font-size: 10px;
        font-weight: 400;
        line-height: 15px;
        word-wrap: break-word;
        text-align: left;
        font-variant-ligatures:normal;
        font-variant-caps:normal;
        font-variant-numeric:normal;
    }
  </style><g filter="url(#a)"><path fill="#fff" d="M-3.7-4h607.5v854.2H-3.7Z"/><mask id="l" fill="#fff"><path d="M24.5 116h547v20h-547z"/></mask><path stroke="#0a0812" stroke-dasharray="2, 2" stroke-opacity=".1" d="M25 754.5h546v63H25Z"/><g fill="#0a0812" fill-opacity=".6" font-family="Inter" font-size="10" font-weight="400" letter-spacing="0" word-spacing="0"><text xml:space="preserve" opacity=".9" style="line-height:1.5;-inkscape-font-specification:&quot;Inter, Normal&quot;;font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-variant-east-asian:normal;text-decoration-color:#000;white-space:pre;shape-inside:url(#b)" transform="translate(11.6 715.9)"><tspan x="24.3" y="89.6"><tspan font-size="8">⁴ Udtrykker den forandring, som vi kan tilskrive interventionen. “Basisalternativ” fratrækkes “Intervention” for at reducere overestimering</tspan></tspan></text><text xml:space="preserve" opacity=".9" style="line-height:1.5;-inkscape-font-specification:&quot;Inter, Normal&quot;;font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-variant-east-asian:normal;text-decoration-color:#000;white-space:pre;shape-inside:url(#c)" transform="translate(11.5 705.1)"><tspan x="24.3" y="89.6"><tspan font-size="8">³ Udtrykker hvor mange/meget, der ellers ville have opnået det valgte outcome, uden en intervention (kontrafaktisk data)</tspan></tspan></text><text xml:space="preserve" opacity=".9" style="line-height:1.5;-inkscape-font-specification:&quot;Inter, Normal&quot;;font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-variant-east-asian:normal;text-decoration-color:#000;white-space:pre;shape-inside:url(#d)" transform="translate(11.5 694)"><tspan x="24.3" y="89.6"><tspan font-size="8">² Udtrykker hvor mange/meget, der opnåede et outcome i interventionen, dvs. “slutmåling - baseline”</tspan></tspan></text><text xml:space="preserve" opacity=".9" style="line-height:1.5;-inkscape-font-specification:&quot;Inter, Normal&quot;;font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-variant-east-asian:normal;text-decoration-color:#000;white-space:pre;shape-inside:url(#b)" transform="translate(11.5 682.7)"><tspan x="24.3" y="89.6"><tspan font-size="8">¹ Personer der er omfattet, af det valgte outcome</tspan></tspan></text></g>
  
    @foreach(var outcomeSummary in value.OutcomeSummaries){
    var effectSize = NumberUtility.LowerAccuracy(outcomeSummary.EffectSize, 2);
    var effectNumber = NumberUtility.LowerAccuracy(outcomeSummary.EffectNumber, 2);
    var benchmark = NumberUtility.LowerAccuracy(outcomeSummary.Benchmark, 2);
    string benchmarkDisplay = benchmark != null && benchmark != 0 ? benchmark.ToString() : " - ";
    string fillColor = "#0a0812"; 
    switch (outcomeSummary.ValueType)
    {
        case "social":
            fillColor = "#2F9C95";
            break;
        case "budgetary":
            fillColor = "#503E8E";
            break;
        case "non-price":
            fillColor = "#0A0812";
            break;
    }

     <g transform="translate(0 @(yOffset) )">
        <path fill="#0a0812" fill-opacity=".1" d="M571.5 135h-547v2h547z" mask="url(#1)"/>
    
        <path fill="@fillColor" fill-opacity=".1" d="M24.5 136h547v67h-547z"/>

        @if (outcomeSummary == value.OutcomeSummaries.Last())
        {
            <path fill="#0a0812" fill-opacity=".1" d="M571.5 632h-547v2h547z" mask="url(#c)" transform="translate(0 -430)"/>
        }

        <text xml:space="preserve" fill="#0a0812" font-family="Inter" font-size="10" font-weight="400" letter-spacing="0" opacity=".9" style="line-height:1.5;-inkscape-font-specification:&quot;Inter, Normal&quot;;font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-variant-east-asian:normal;text-decoration-color:#000;white-space:pre;shape-inside:url(#d)" transform="translate(163 83.6)" word-spacing="0"><tspan x="24.3" y="89.6">@outcomeSummary.EffectType</tspan></text>
        <foreignObject id="beneficiary-name" width="78" height="36" x="262" y="164"><div>@outcomeSummary.BeneficiaryName</div></foreignObject>
        <text xml:space="preserve" fill="#0a0812" font-family="Inter" font-size="10" font-weight="400" letter-spacing="0" opacity=".9" style="line-height:1.5;-inkscape-font-specification:&quot;Inter, Normal&quot;;font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-variant-east-asian:normal;text-decoration-color:#000;white-space:pre;shape-inside:url(#f)" transform="translate(324.3 83.1)" word-spacing="0"><tspan x="24.3" y="89.6">@outcomeSummary.PopulationSize</tspan></text><text xml:space="preserve" fill="#0a0812" font-family="Inter" font-size="10" font-weight="400" letter-spacing="0" opacity=".9" style="line-height:1.5;-inkscape-font-specification:&quot;Inter, Normal&quot;;font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-variant-east-asian:normal;text-decoration-color:#000;white-space:pre;shape-inside:url(#g)" transform="translate(357.2 82.8)" word-spacing="0"><tspan x="24.3" y="89.6">@effectSize</tspan></text><text xml:space="preserve" fill="#0a0812" font-family="Inter" font-size="10" font-weight="400" letter-spacing="0" opacity=".9" style="line-height:1.5;-inkscape-font-specification:&quot;Inter, Normal&quot;;font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-variant-east-asian:normal;text-decoration-color:#000;white-space:pre;shape-inside:url(#h)" transform="translate(428.2 83.4)" word-spacing="0"><tspan x="24.3" y="89.6">@benchmarkDisplay</tspan></text><g transform="translate(0 -430)"><rect width="35" height="25" x="525.5" y="587" fill="#0a0812" fill-opacity=".9" rx="4"/><text xml:space="preserve" x="543" y="603.8" fill="#fff" font-family="Inter" font-size="12" font-weight="600" text-anchor="middle"><tspan x="543" y="603.8">@effectNumber</tspan></text></g><g transform="translate(-21.2 -218.3)"><foreignObject id="outcome-description" width="147" height="36" x="54" y="376" style="width:147px;height:36px;gap:0"><div font-family="Inter" font-size="8" font-weight="400" style="word-wrap:break-word;line-height:12px;text-align:left">@outcomeSummary.OutcomeDescription</div></foreignObject><text xml:space="preserve" font-family="Inter" font-size="10" font-weight="400" letter-spacing="0" style="line-height:1.5;-inkscape-font-specification:&quot;Inter, Normal&quot;;font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-variant-east-asian:normal;text-decoration-color:#000;white-space:pre;shape-inside:url(#i)" transform="translate(29 281.7)" word-spacing="0"><tspan x="24.3" y="89.6"><tspan fill="#0a0812" font-weight="600">@outcomeSummary.OutcomeName</tspan></tspan></text></g>
    </g>
     yOffset += 68;
  }
  
  <text xml:space="preserve" fill="#000" fill-opacity=".6" font-family="Inter" font-size="10" font-weight="400" letter-spacing="0" opacity=".9" style="line-height:1.5;-inkscape-font-specification:&quot;Inter, Normal&quot;;font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-variant-east-asian:normal;text-decoration-color:#000;white-space:pre;shape-inside:url(#j)" transform="translate(6.3 35.4)" word-spacing="0"><tspan x="24.3" y="89.6"><tspan font-size="8" font-weight="700"> Outcome</tspan></tspan></text><text xml:space="preserve" fill="#000" fill-opacity=".6" font-family="Inter" font-size="10" font-weight="400" letter-spacing="0" opacity=".9" style="line-height:1.5;-inkscape-font-specification:&quot;Inter, Normal&quot;;font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-variant-east-asian:normal;text-decoration-color:#000;white-space:pre;shape-inside:url(#e)" transform="translate(239.3 35.4)" word-spacing="0"><tspan x="24.3" y="89.6"><tspan font-size="8" font-weight="700"> Gevinstmodtager</tspan></tspan></text><text xml:space="preserve" fill="#000" fill-opacity=".6" font-family="Inter" font-size="10" font-weight="400" letter-spacing="0" opacity=".9" style="line-height:1.5;-inkscape-font-specification:&quot;Inter, Normal&quot;;font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-variant-east-asian:normal;text-decoration-color:#000;white-space:pre;shape-inside:url(#k)" transform="translate(324.3 35.4)" word-spacing="0"><tspan x="24.3" y="89.6"><tspan font-size="8" font-weight="700">n¹</tspan></tspan></text><text xml:space="preserve" fill="#000" fill-opacity=".6" font-family="Inter" font-size="10" font-weight="400" letter-spacing="0" opacity=".9" style="line-height:1.5;-inkscape-font-specification:&quot;Inter, Normal&quot;;font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-variant-east-asian:normal;text-decoration-color:#000;white-space:pre;shape-inside:url(#prefix__p)" transform="translate(161.4 35.4)" word-spacing="0"><tspan x="24.3" y="89.6"><tspan font-size="8" font-weight="700"> Enhed</tspan></tspan></text><text xml:space="preserve" fill="#000" fill-opacity=".6" font-family="Inter" font-size="10" font-weight="400" letter-spacing="0" opacity=".9" style="line-height:1.5;-inkscape-font-specification:&quot;Inter, Normal&quot;;font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-variant-east-asian:normal;text-decoration-color:#000;white-space:pre;shape-inside:url(#prefix__q)" transform="translate(355.4 35.4)" word-spacing="0"><tspan x="24.3" y="89.6"><tspan font-size="8" font-weight="700"> Intervention²</tspan></tspan></text><text xml:space="preserve" fill="#000" fill-opacity=".6" font-family="Inter" font-size="10" font-weight="400" letter-spacing="0" opacity=".9" style="line-height:1.5;-inkscape-font-specification:&quot;Inter, Normal&quot;;font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-variant-east-asian:normal;text-decoration-color:#000;white-space:pre;shape-inside:url(#g)" transform="translate(420.2 35.4)" word-spacing="0"><tspan x="24.3" y="89.6"><tspan font-size="8" font-weight="700">Basisalternativ³</tspan></tspan></text><text xml:space="preserve" fill="#000" fill-opacity=".6" font-family="Inter" font-size="10" font-weight="400" letter-spacing="0" opacity=".9" style="line-height:1.5;-inkscape-font-specification:&quot;Inter, Normal&quot;;font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-variant-east-asian:normal;text-decoration-color:#000;white-space:pre;shape-inside:url(#prefix__s)" transform="translate(503.1 35.3)" word-spacing="0"><tspan x="24.3" y="89.6"><tspan font-size="8" font-weight="700">Effekttal⁴</tspan></tspan></text><text xml:space="preserve" fill="#000" fill-opacity=".6" font-family="Inter" font-size="10" font-weight="400" letter-spacing="0" opacity=".9" style="line-height:1.5;-inkscape-font-specification:&quot;Inter, Normal&quot;;font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-variant-east-asian:normal;text-decoration-color:#000;white-space:pre;shape-inside:url(#h)" transform="translate(408.2 35.2)" word-spacing="0"><tspan x="24.3" y="89.6"><tspan font-size="8" font-weight="700">  - </tspan></tspan></text><text xml:space="preserve" fill="#000" fill-opacity=".6" font-family="Inter" font-size="10" font-weight="400" letter-spacing="0" opacity=".9" style="line-height:1.5;-inkscape-font-specification:&quot;Inter, Normal&quot;;font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-variant-east-asian:normal;text-decoration-color:#000;white-space:pre;shape-inside:url(#prefix__u)" transform="translate(482.5 35.2)" word-spacing="0"><tspan x="24.3" y="89.6"><tspan font-size="8" font-weight="700">  = </tspan></tspan></text><path fill="#0a0812" fill-opacity=".1" d="M571.5 135h-547v2h547z" mask="url(#l)"/><path fill="#503E8E" d="M210.5 77.5h73v12h-73z"/><text xml:space="preserve" x="246.9" y="86.6" fill="#fff" font-family="Inter" font-size="8" font-weight="500" text-anchor="middle"><tspan x="246.9" y="86.6" font-weight="500">Budgetøkonomisk</tspan></text><path fill="#2F9C95" d="M293.5 77.5h69v12h-69z"/><text xml:space="preserve" x="327.8" y="86.1" fill="#fff" font-family="Inter" font-size="8" font-weight="500" text-anchor="middle"><tspan x="327.8" y="86.1" font-weight="500">Socialøkonomisk</tspan></text><path fill="#0A0812" fill-opacity=".9" d="M372.5 77.5h57v12h-57z"/><text xml:space="preserve" x="400.9" y="86.5" fill="#fff" font-family="Inter" font-size="8" font-weight="500" text-anchor="middle"><tspan x="400.9" y="86.5" font-weight="500">Ikke-værdisat</tspan></text><text xml:space="preserve" font-family="Inter" font-size="10" font-weight="400" letter-spacing="0" style="line-height:1.5;-inkscape-font-specification:&quot;Inter, Normal&quot;;font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-variant-east-asian:normal;text-decoration-color:#000;white-space:pre;shape-inside:url(#m)" transform="translate(142.2 -2.6)" word-spacing="0"><tspan x="24.3" y="89.6"><tspan fill="#0a0812">Farver:</tspan></tspan></text><path stroke="#0A0812" stroke-dasharray="2 2" stroke-opacity=".1" stroke-width=".5" d="M24.8 103.3h546.5v.5H24.8z"/><mask id="c" fill="#fff"><path d="M24.5 566h547v67h-547z"/></mask><path fill="#1C1632" d="M24.5 28a4 4 0 0 1 4-4h539a4 4 0 0 1 4 4v36h-547z"/><path fill="#EF5D43" d="M201.2 37.3a1.7 1.7 0 1 1-3.4 0 1.7 1.7 0 0 1 3.4 0m-2.5 10v5H197v-10a2.5 2.5 0 0 1 4.3-1.7l2 1.8 1.9-2 1.1 1.3-3 3-1.3-1.2v8.8h-1.7v-5zm.8-5.8q-.8.1-.8.8v3.4h1.6v-3.4q0-.7-.8-.8m10.8-3.3h-7.5v-1.7h8.4q.7.1.8.8v9.2q-.1.8-.8.8h-2.9l2.4 5h-1.9l-2.3-5h-3.7v-1.6h7.5z"/><text xml:space="preserve" x="51.7" fill="#fff" font-family="Inter" font-size="10" font-weight="400" letter-spacing="0" style="line-height:1.5;-inkscape-font-specification:&quot;Inter, Normal&quot;;font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-variant-east-asian:normal;text-align:center;text-decoration-color:#000;white-space:pre;shape-inside:url(#n)" transform="translate(176 -45.7)" word-spacing="0"><tspan x="42.3" y="95.7"><tspan font-family="Lora" font-size="16"> Resultater og outcomes </tspan></tspan></text></g><defs><path id="n" d="M24.3 79.1h218.9v25.2H24.3z"/><path id="m" d="M24.3 79.1H61v15.6H24.3z"/><path id="e" d="M24.3 79.1h75.4v14.2H24.3z"/><path id="k" d="M24.3 79.1h10.4v15.4H24.3z"/><path id="i" d="M24.3 79.1h121.5v16H24.3z"/><path id="j" d="M24.3 79.1h57v14.5h-57z"/><path id="h" d="M24.3 79.1h13.2v13.5H24.3z"/><path id="g" d="M24.3 79.1h64v13.5h-64z"/><path id="d" d="M24.3 79.1h48.8v15.3H24.3z"/><path id="f" d="M24.3 79.1h30.3v15.8H24.3z"/><path id="b" d="M24.3 79.1h530.4v14H24.3z"/><filter id="a" width="599" height="846" x=".5" y="0" color-interpolation-filters="sRGB" filterUnits="userSpaceOnUse"><feFlood flood-opacity="0" result="BackgroundImageFix"/><feColorMatrix in="SourceAlpha" result="hardAlpha" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 127 0"/><feOffset dx="4" dy="4"/><feComposite in2="hardAlpha" operator="out"/><feColorMatrix values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0.15 0"/><feBlend in2="BackgroundImageFix" result="effect1_dropShadow_870_4066"/><feBlend in="SourceGraphic" in2="effect1_dropShadow_870_4066" result="shape"/></filter></defs></svg>
   }
</body>